
{% extends "base.html" %}

{% block content %}
<div class="container mt-4 mb-4">

  <!-- Grievance Details -->
  <div class="card shadow-lg border-0 rounded-3">
    <div class="card-body p-4">
      <div class="row g-4">

        <!-- Left: Info -->
        <div class="col-md-8">
          <h3 class="text-success fw-bold mb-4">{{ grievance.title }}</h3>

          <div class="fs-6 lh-lg">  <!-- Increased line spacing here -->
            <p><strong>Description:</strong> {{ grievance.description }}</p>
            
            <p>
              <strong>Status:</strong>
              <span class="badge fs-6
                {% if grievance.status == 'Resolved' %} bg-success
                {% elif grievance.status == 'Pending' %} bg-warning text-dark
                {% else %} bg-danger {% endif %}">
                {{ grievance.status }}
              </span>
            </p>

            <p><strong>Department:</strong> {{ grievance.department.name if grievance.department else 'â€”' }}</p>
            <p><strong>Reported By:</strong> {{ grievance.user.username if grievance.user else 'Anonymous' }}</p>
            <p><strong>Created On:</strong> {{ grievance.created_at.strftime('%Y-%m-%d %H:%M') if grievance.created_at else 'â€”' }}</p>
            <p><strong>Location:</strong> {{ grievance.location or 'â€”' }}</p>
            <p><strong>ğŸ‘ Likes:</strong> <span class="fw-bold text-primary">{{ like_count }}</span></p>
          </div>
        </div>

        <!-- Right: Image Centered -->
        <div class="col-md-4 d-flex justify-content-center align-items-center">
          {% if grievance.image %}
            <img src="{{ url_for('static', filename='uploads/' ~ grievance.image) }}" 
                 alt="Grievance Image" 
                 class="img-fluid rounded shadow-sm border"
                 style="max-height:240px; object-fit:cover;">
          {% else %}
            <div class="text-muted fst-italic">No image uploaded</div>
          {% endif %}
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="mt-4 d-flex gap-2">
        <a href="{{ url_for('a_delete_grievance', id=grievance.id) }}" 
           class="btn btn-outline-danger"
           onclick="return confirm('Are you sure you want to delete this grievance?');">
          ğŸ—‘ Delete
        </a>
        <a href="{{ url_for('a_view_grievances') }}" class="btn btn-outline-secondary">â¬… Back</a>
      </div>
    </div>
  </div>

  <!-- Comments Section -->
  <div class="card shadow-sm border-0 rounded-3 mt-4">
    <div class="card-body p-4">
      <h5 class="text-success mb-3">ğŸ’¬ Comments</h5>

      {% if comments %}
        <ul class="list-group list-group-flush">
          {% for comment in comments %}
            <li class="list-group-item py-3">  <!-- More vertical spacing in comments too -->
              <div class="d-flex justify-content-between">
                <span>
                  <strong>{{ comment.user.username if comment.user else 'Anonymous' }}:</strong>
                  {{ comment.content }}
                </span>
                <small class="text-muted">{{ comment.created_at.strftime('%Y-%m-%d %H:%M') if comment.created_at else '' }}</small>
              </div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-muted fst-italic">No comments yet.</p>
      {% endif %}
    </div>
  </div>

</div>
{% endblock %}
